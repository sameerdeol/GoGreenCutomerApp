<app-common-header></app-common-header>
<ion-content [fullscreen]="true">

  <!-- Pull to Refresh -->
  <ion-refresher slot="fixed" (ionRefresh)="doRefresh($event)">
    <ion-refresher-content
      pullingIcon="arrow-down"
      pullingText="Pull to refresh"
      refreshingSpinner="circles"
      refreshingText="Refreshing...">
    </ion-refresher-content>
  </ion-refresher>

  <div class="page_outer_div">

    <!-- Filters -->
    <div class="filter_header">
      <swiper-container class="mySwiper" slides-per-view="2.5" space-between="5" autoplay="false" [breakpoints]="{
        '640': { 'slidesPerView': 5, 'spaceBetween': 5 },
        '768': { 'slidesPerView': 5, 'spaceBetween': 5 },
        '1024': { 'slidesPerView': 5, 'spaceBetween': 5 }
      }">
        <swiper-slide *ngFor="let filter of filters" (click)="OnFilterClick(filter)">
          <div class="slide-content filter_slide" [class.active]="selectedFilter === filter">
            <span>{{ filter }}</span>
          </div>
        </swiper-slide>
      </swiper-container>
    </div>

    <!-- Orders -->
    <ng-container *ngIf="filteredOrders.length > 0; else noOrdersTemplate">
      <ion-card *ngFor="let order of filteredOrders" class="order_card">
        <!-- Header -->
        <ion-card-header class="card_header">
          <div class="header_inner_div">
            <ion-card-subtitle>{{order.order_uid}}</ion-card-subtitle>
            <div class="order_status">
         {{ getOrderStatusText(order.order_status) }}
            </div>
          </div>
        </ion-card-header>

        <!-- Product Images -->
        <div class="order_top_row">
          <!-- Single Product -->
          <ng-container *ngIf="order.products.length === 1">
            <img [src]="order.products[0].featured_image"
                 alt="{{ order.products[0].product_name }}"
                 class="single-product-image" />
          </ng-container>

          <!-- Multiple Products -->
          <ng-container *ngIf="order.products.length > 1">
            <div class="image_grid_2col">
              <img [src]="order.products[0].featured_image"
                   alt="{{ order.products[0].product_name }}"
                   class="grid-image" />

              <div class="image_wrapper">
                <img [src]="order.products[1].featured_image"
                     alt="{{ order.products[1].product_name }}"
                     class="grid-image" />
                <div class="extra_count" *ngIf="order.products.length > 2">
                  +{{ order.products.length - 2 }}
                </div>
              </div>
            </div>
          </ng-container>

          <!-- Product Info -->
          <div class="product_info">
            <div class="product_name">{{ order.products[0].product_name }}</div>
            <div class="order_meta">
              {{ order.products.length }} items â€¢ Ordered {{ order.created_at | date:'M/d/yyyy' }}
            </div>
            <div class="order_price">${{ order.total_price }}</div>
          </div>
        </div>

        <!-- Footer -->
        <div class="card_footer">
          <div class="footer_btn" (click)="onClickViewDetails(order)">View Details</div>
          <div class="active_footer_btn">Buy Again</div>
        </div>
      </ion-card>
    </ng-container>

    <!-- Empty state -->
    <ng-template #noOrdersTemplate>
      <div class="no-orders">
        <!-- <img src="assets/no-orders.png" alt="No Orders" class="no-orders-img" /> -->
        <p *ngIf="selectedFilter === 'All Orders'">No orders found</p>
        <p *ngIf="selectedFilter === 'Delivered'">No delivered orders yet</p>
        <p *ngIf="selectedFilter === 'Cancelled'">No cancelled orders</p>
        <p *ngIf="selectedFilter === 'Pending'">No pending orders</p>
      </div>
    </ng-template>

  </div>
</ion-content>
